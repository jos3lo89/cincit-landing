---
import { Calendar, House, UserPlus, Users } from "@lucide/astro";

const navItems = [
  { icon: House, label: "Inicio", href: "/" },
  { icon: Calendar, label: "Ponencias", href: "/schedule" },
  // { icon: GalleryVertical, label: "Galería", href: "/gallery" },
  { icon: Users, label: "Nosotros", href: "/about" },
  { icon: UserPlus, label: "Inscríbete", href: "/register" },
];
---

<div
  class="fixed bottom-6 z-50 left-6 right-6 md:left-1/2 md:right-auto md:-translate-x-1/2"
>
  <nav
    id="main-nav"
    class="bg-slate-900/95 border border-slate-700/50 rounded-2xl px-1 py-1 shadow-2xl shadow-black/20"
  >
    <div class="grid grid-cols-4 gap-1 md:gap-6 text-center">
      {
        navItems.map((item) => {
          const Icon = item.icon;
          return (
            <a
              href={item.href}
              class="nav-link py-2 md:px-1 rounded-xl transition-all duration-300 group text-slate-300 hover:text-white hover:bg-slate-800/60"
              data-astro-prefetch
              data-href={item.href}
            >
              <div class="flex justify-center items-center flex-col gap-1">
                <Icon
                  size={20}
                  class="nav-icon transition-all duration-300 text-slate-300 group-hover:text-white group-hover:scale-105"
                />
                <span class="nav-text text-xs font-medium transition-all duration-300 text-slate-400 group-hover:text-white">
                  {item.label}
                </span>
              </div>
            </a>
          );
        })
      }
    </div>
  </nav>
</div>

<style scoped>
  .nav-link.active {
    background-color: rgb(37 99 235 / 0.2);
    box-shadow:
      0 10px 15px -3px rgb(59 130 246 / 0.25),
      0 4px 6px -2px rgb(59 130 246 / 0.1);
    border: 1px solid rgb(59 130 246 / 0.3);
    color: white;
  }

  .nav-link.active .nav-icon {
    color: rgb(96 165 250);
  }

  @media (min-width: 768px) {
    .nav-link.active .nav-icon {
      transform: scale(1.1);
    }
  }
  .nav-link.active .nav-text {
    color: rgb(96 165 250);
  }
</style>

<script>
  const updateActiveLink = () => {
    const navLinks = document.querySelectorAll("#main-nav .nav-link");
    const currentPath = window.location.pathname;

    navLinks.forEach((link) => {
      const linkPath = link.getAttribute("data-href");

      if (!linkPath) return;

      const isActive =
        linkPath === "/"
          ? currentPath === "/"
          : currentPath.startsWith(linkPath);

      link.classList.toggle("active", isActive);
    });
  };

  updateActiveLink();
  document.addEventListener("astro:after-swap", updateActiveLink);
</script>
